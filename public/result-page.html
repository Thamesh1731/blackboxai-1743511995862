<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Results - Exam Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-graduation-cap text-blue-600"></i>
                <h1 class="text-xl font-bold">Exam Portal</h1>
            </div>
            <a href="student-dashboard.html" class="text-blue-600 hover:text-blue-800">
                <i class="fas fa-arrow-left mr-1"></i> Back to Dashboard
            </a>
        </div>
    </header>

    <!-- Result Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Result Summary -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 text-white">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-2xl font-bold" id="testTitle">Mathematics Midterm Exam</h2>
                            <p class="opacity-90">Completed on <span id="completionDate">May 20, 2023</span></p>
                        </div>
                        <div class="text-center">
                            <div class="text-5xl font-bold" id="scorePercentage">85%</div>
                            <div class="text-sm opacity-90">Your Score</div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6">
                    <div class="flex flex-col md:flex-row justify-between space-y-4 md:space-y-0">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600" id="correctAnswers">17</div>
                            <div class="text-gray-600">Correct Answers</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-red-600" id="wrongAnswers">3</div>
                            <div class="text-gray-600">Incorrect Answers</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-blue-600" id="totalQuestions">20</div>
                            <div class="text-gray-600">Total Questions</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-yellow-600" id="timeTaken">25:30</div>
                            <div class="text-gray-600">Time Taken</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Breakdown -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="font-semibold text-lg">Performance Breakdown</h3>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium">Overall Performance</span>
                            <span class="text-sm font-medium">85%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-blue-600 h-2.5 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-medium mb-2">Topics Performance</h4>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Algebra</span>
                                        <span>90%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: 90%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Geometry</span>
                                        <span>75%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 75%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Trigonometry</span>
                                        <span>80%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-blue-500 h-2 rounded-full" style="width: 80%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-medium mb-2">Question Types</h4>
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Multiple Choice</span>
                                        <span>88%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-purple-500 h-2 rounded-full" style="width: 88%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Short Answer</span>
                                        <span>70%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-red-500 h-2 rounded-full" style="width: 70%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Question Review -->
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="font-semibold text-lg">Question Review</h3>
                </div>
                <div class="divide-y divide-gray-200">
                    <!-- Correct Answer Example -->
                    <div class="p-6">
                        <div class="flex items-start mb-3">
                            <span class="bg-green-100 text-green-800 font-bold rounded-full h-6 w-6 flex items-center justify-center mr-3 mt-1">1</span>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">What is the value of Ï€ (pi) rounded to two decimal places?</h4>
                                <div class="mt-3 space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-5 h-5 rounded-full bg-green-500 flex items-center justify-center mr-2">
                                            <i class="fas fa-check text-white text-xs"></i>
                                        </div>
                                        <span class="bg-green-50 text-green-800 px-2 py-1 rounded">3.14 (Your Answer)</span>
                                    </div>
                                    <div class="text-sm text-gray-500 ml-7">Correct answer: 3.14</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Incorrect Answer Example -->
                    <div class="p-6">
                        <div class="flex items-start mb-3">
                            <span class="bg-red-100 text-red-800 font-bold rounded-full h-6 w-6 flex items-center justify-center mr-3 mt-1">2</span>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">Solve for x: 2x + 5 = 15</h4>
                                <div class="mt-3 space-y-2">
                                    <div class="flex items-center">
                                        <div class="w-5 h-5 rounded-full bg-red-500 flex items-center justify-center mr-2">
                                            <i class="fas fa-times text-white text-xs"></i>
                                        </div>
                                        <span class="bg-red-50 text-red-800 px-2 py-1 rounded">7 (Your Answer)</span>
                                    </div>
                                    <div class="text-sm text-green-600 ml-7">Correct answer: 5</div>
                                    <div class="mt-2 ml-7 text-sm bg-blue-50 p-2 rounded">
                                        <p class="font-medium text-blue-800">Explanation:</p>
                                        <p class="text-blue-700">Subtract 5 from both sides: 2x = 10. Then divide both sides by 2: x = 5.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Text Answer Example -->
                    <div class="p-6">
                        <div class="flex items-start mb-3">
                            <span class="bg-yellow-100 text-yellow-800 font-bold rounded-full h-6 w-6 flex items-center justify-center mr-3 mt-1">3</span>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">Explain the Pythagorean theorem in your own words.</h4>
                                <div class="mt-3">
                                    <div class="mb-2">
                                        <p class="font-medium text-sm text-gray-700">Your Answer:</p>
                                        <div class="bg-gray-50 p-3 rounded mt-1">
                                            <p class="text-gray-800">It's about right triangles and the sides.</p>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <p class="font-medium text-sm text-green-600">Model Answer:</p>
                                        <div class="bg-green-50 p-3 rounded mt-1">
                                            <p class="text-green-800">In a right-angled triangle, the square of the hypotenuse (the side opposite the right angle) is equal to the sum of the squares of the other two sides.</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center text-sm text-gray-500">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        <span>This question was graded manually by your instructor.</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-4 border-t border-gray-200 text-center">
                    <button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        <i class="fas fa-download mr-2"></i> Download Result PDF
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Load result data from API
        async function loadResult() {
            try {
                const testId = new URLSearchParams(window.location.search).get('testId');
                if (!testId) {
                    window.location.href = 'student-dashboard.html';
                    return;
                }
                
                const response = await fetch(`/api/results/${testId}`);
                const resultData = await response.json();
                
                if (response.ok) {
                    // Update the UI with real data
                    document.getElementById('testTitle').textContent = resultData.testTitle;
                    document.getElementById('completionDate').textContent = new Date(resultData.completedAt).toLocaleDateString();
                    document.getElementById('scorePercentage').textContent = `${resultData.scorePercentage}%`;
                    document.getElementById('correctAnswers').textContent = resultData.correctAnswers;
                    document.getElementById('wrongAnswers').textContent = resultData.wrongAnswers;
                    document.getElementById('totalQuestions').textContent = resultData.totalQuestions;
                    
                    // Format time taken
                    const minutes = Math.floor(resultData.timeTaken / 60);
                    const seconds = resultData.timeTaken % 60;
                    document.getElementById('timeTaken').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    
                    // Render question review dynamically
                    // This would replace the static examples in the HTML
                }
            } catch (error) {
                console.error('Error loading result:', error);
            }
        }
        
        // Call on page load
        loadResult();
    </script>
</body>
</html>